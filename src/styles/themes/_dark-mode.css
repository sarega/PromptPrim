/* ===============================================
   FILE: src/styles/themes/_dark-mode.css (สมบูรณ์)
   DESCRIPTION: Theme สี Dark กลืนทุก element + วงกลม action โปร่งใส + ปรับ #agent-enhancer-column
   =============================================== */

body.dark-mode {
    --primary-color: #7f9cf5;
    --secondary-color: #a78bfa;
    --background-gradient: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
  
    --text-dark: #e2e8f0;
    --text-light: #1a202c;
    --border-color: #4a5568;
    --white-alpha-95: rgba(26, 32, 44, 0.85);
    --white-alpha-50: rgba(45, 55, 72, 0.5);
    /* [NEW] Workspace Background Overrides for Dark Mode */
    --bg-workspace-chat: #1e293b;   /* สีเทาน้ำเงินเข้มสำหรับหน้าแชท */
    --bg-workspace-studio: #1e293b; /* สีเทาน้ำเงินเข้มสำหรับหน้า Studio */ 
    --user-bubble-text-color: #e2e8f0; /* <--- เพิ่มบรรทัดนี้ (สีเทาอ่อนเกือบขาว) */
    --user-bubble-edit-text-color: #f7fafc; /* <--- เพิ่มบรรทัดนี้ */
    --primary-color-dark: #394990; /* <--- เพิ่มบรรทัดนี้ */
    --btn-primary-bg: #2f3c4f;      /* <--- สีพื้นหลังที่คุณชอบ */
    --btn-primary-border: #4a5568;  /* <--- สีขอบที่เข้ากัน */

    background: #1a202c;
    color: var(--text-dark);
}

/*
 * Specific background color for side panels in Dark Mode.
 * This rule targets the panels directly when dark mode is active.
 */
body.dark-mode .sessions-panel,
body.dark-mode .composer-panel {
    background-color: #1a202c; /* สีเทา-น้ำเงินที่เข้มกว่าพื้นหลังเล็กน้อย */
}

body.dark-mode .sidebar { background: var(--white-alpha-95); }
body.dark-mode #settings-panel { background: #2d3748; }
body.dark-mode .main-chat-area { background: #2d3748cc; }
body.dark-mode input[type="text"],
body.dark-mode input[type="password"],
body.dark-mode input[type="number"],
body.dark-mode select,
body.dark-mode textarea {
    background-color: #4a5568;
    color: var(--text-dark);
    border-color: #718096;
}
body.dark-mode input:-webkit-autofill,
body.dark-mode input:-webkit-autofill:hover,
body.dark-mode input:-webkit-autofill:focus,
body.dark-mode input:-webkit-autofill:active {
    -webkit-box-shadow: 0 0 0 30px #4a5568 inset !important;
    -webkit-text-fill-color: var(--text-dark) !important;
}
body.dark-mode .message.assistant { background: #232e42; border-color: #718096; } /* background: #4a5568 */
body.dark-mode .message.system { background: #4a5568; color: #a0aec0; border-color: #718096; }
body.dark-mode .item-list > .item { background-color: #2d3748; border-color: #4a5568; }
body.dark-mode .item-list > .item.active { border-color: var(--success-color); background-color: #2c4736; }
body.dark-mode .item-list > .item:hover {
    background-color: #3e4c5f;
    border-color: #5a6b82;
}

/* [ADD THIS] เพิ่มกฎสำหรับ Item ที่ active และถูก hover พร้อมกัน */
body.dark-mode .item-list > .item.active:hover {
    background-color: #2c4736;          /* <--- ใช้สีเดียวกับ .active */
    border-color: var(--success-color); /* <--- ใช้สีขอบเดียวกับ .active */
}
body.dark-mode .item-list > .item.pinned { background-color: #3c3658; }
body.dark-mode .item-name { color: var(--text-dark); }
body.dark-mode .collapsible-section summary { color: #a0aec0; }
body.dark-mode .collapsible-section summary:hover { background-color: #4a5568; }
body.dark-mode .collapsible-section summary:hover h3 { color: var(--text-dark); }
body.dark-mode .summary-log-item { background: #2d3748; border-left-color: #4a5568; }
body.dark-mode .summary-log-item.active { border-left-color: var(--success-color); background: #2c4736; }
body.dark-mode .summary-log-item-title { color: #cbd5e0; }
body.dark-mode .memory-toggle { background: #718096; }
body.dark-mode .memory-toggle.active { background: var(--success-color); }
body.dark-mode .dropdown-content { background-color: #2d3748; border: 1px solid #4a5568; }
body.dark-mode .dropdown-content a { color: var(--text-dark); }
body.dark-mode .dropdown-content a:hover { background-color: #4a5568; }
body.dark-mode .dropdown-content hr { border-top-color: #4a5568; }
body.dark-mode .btn-icon { color: #a0aec0; }
body.dark-mode .btn-icon:hover { background: #4a5568; color: var(--text-dark); }
body.dark-mode .btn-secondary { background: #718096; color: #e2e8f0; }
body.dark-mode .modal-box { background: #2d3748; }
body.dark-mode #context-inspector-modal pre { background: #1a202c; border-color: #4a5568; color: #cbd5e0; }
body.dark-mode #chat-actions-menu { background-color: #2d3748; border-color: #4a5568; }
body.dark-mode #chat-actions-menu a { color: var(--text-dark); }
body.dark-mode #chat-actions-menu a:hover { background-color: #4a5568; }
body.dark-mode .agent-enhancer-column {
  background-color: #1a202c !important; /* หรือ #232d3e */
  border-color: #4a5568 !important;
}body.dark-mode #group-member-list { border-color: #4a5568; }
body.dark-mode .agent-sortable-item { background-color: #2d3748; border-color: #4a5568; }
body.dark-mode .agent-sortable-item .drag-handle { color: #718096; }
body.dark-mode code { background-color: #4a5568; color: #f7fafc; }
body.dark-mode .message-content pre code { background-color: transparent; }
body.dark-mode .inline-edit-textarea { background-color: #2d3748; color: var(--text-dark); border-color: var(--primary-color); }
body.dark-mode hr { border-top-color: #4a5568; }
body.dark-mode *::-webkit-scrollbar-thumb { background-color: #718096; border-radius: 5px; border: 2px solid #2d3748; }
body.dark-mode *::-webkit-scrollbar-thumb:hover { background-color: #a0aec0; }
body.dark-mode *::-webkit-scrollbar { background: #21222c; }
body.dark-mode .modal-warning { color: #a0aec0; }
body.dark-mode .enhancer-status-box { color: #a0aec0; }
body.dark-mode .sidebar-resizer { background: #2d3748; border-top: 1px solid #4a5568; border-bottom: 1px solid #4a5568; }
body.dark-mode .sidebar-resizer:hover { background: var(--primary-color); opacity: 0.6; }
/* [ADD THIS] เพิ่มกฎสำหรับ User Bubble โดยเฉพาะใน Dark Mode */
body.dark-mode .message.user {
    background: #070a11; /* หรือสีน้ำเงินเข้มอื่นๆ ที่คุณต้องการ #1a202c*/
    color: var(--user-bubble-text-color); /* ใช้ตัวแปรที่เราสร้างไว้ */
}

/* [VERIFY/FIX THIS] แก้ไขกฎสำหรับ Textarea ตอน Edit ให้สมบูรณ์ */
body.dark-mode .message.user .inline-edit-textarea {
    background-color: rgba(10, 10, 25, 0.3); /* พื้นหลังให้เข้มขึ้นเล็กน้อย */
    color: var(--user-bubble-edit-text-color) !important; /* ใช้ !important เพื่อความชัวร์ */
    border-color: #1a202c; /* สีขอบให้เข้ากับสี Bubble ใหม่ */
}
body.dark-mode .custom-select-trigger { background-color: #4a5568; border-color: #718096; }
body.dark-mode .custom-select-arrow { border-top-color: #cbd5e0; }
body.dark-mode .custom-select-options { background-color: #2d3748; border-color: #4a5568; }
body.dark-mode .custom-select-group { color: #a0aec0; }
body.dark-mode .custom-select-option:hover { background-color: #4a5568; }
body.dark-mode .input-container-seamless { background-color: #2d3748; border-color: #4a5568; }
body.dark-mode .input-container-seamless:focus-within { box-shadow: 0 0 0 3px rgba(127, 156, 245, 0.4); border-color: var(--primary-color); }
body.dark-mode #chatInput { color: #e2e8f0; }
body.dark-mode #chatInput::placeholder { color: #a0aec0; }
body.dark-mode #chat-actions-btn { color: #bdc1c6; }
body.dark-mode .speaker-label { color: var(--primary-color); }
body.dark-mode .file-preview-item { background-color: #2d3748; border-color: #4a5568; }

/* --- Item-specific styling for Dark Mode --- */
body.dark-mode .sidebar .session-item.archived .item-name { color: #919191; }
body.dark-mode .session-item.archived { opacity: 0.8; }
body.dark-mode .item-list > .group-item { background-color: #3a4454; border-left-color: var(--primary-color);}
body.dark-mode .inactive .item-name { opacity: 0.9; }
body.dark-mode .sidebar .memory-item.inactive .item-name { color: #b6b6b6;}

/* Section heading ถ้าใช้ <summary> (เช่น Chat Session, Agent Groups ฯลฯ) */
body.dark-mode .collapsible-section > summary {
  color: #c9d1d9;
  font-weight: 600;
  letter-spacing: 0.5px;
}
/* ถ้าใช้ h3/h4 ใน sidebar */
body.dark-mode .sidebar h3,
body.dark-mode .sidebar h4 {
  color: #c9d1d9;
  font-weight: 600;
}
/* ถ้าใช้ label หรือ .section-title */
body.dark-mode .sidebar label,
body.dark-mode .sidebar .section-title {
  color: #c9d1d9;
  font-weight: 600;
}


/* [NEW] ปุ่ม Edit/Delete/3จุด: วงกลมโปร่งใส, hover มีสี */
body.dark-mode .session-item button,
body.dark-mode .session-item .item-action,
body.dark-mode .agent-preset button,
body.dark-mode .agent-preset .item-action {
  background: transparent !important;
  color: #c9d1d9 !important;
  border-radius: 50%;
  border: none;
  transition: background 0.12s;
}

/* [NEW] Hover แล้ววงกลมสีอ่อน */
body.dark-mode .session-item button:hover,
body.dark-mode .session-item .item-action:hover,
body.dark-mode .agent-preset button:hover,
body.dark-mode .agent-preset .item-action:hover {
  background: #334155 !important;
  color: #fff !important;
}
/* [ปุ่มใน หัวข้อ section ใน side bar  */
body.dark-mode .btn-icon {
  background: transparent !important;
  color: #c9d1d9 !important;
  border: none;
}
body.dark-mode .btn-icon:hover {
  background: #334155 !important;
  color: #fff !important;
}

body.dark-mode .workspace#agent-asset-studio {
    background-color: var(--bg-workspace-studio);
}

/* For Dark Mode */
body.dark-mode .streaming-code-preview {
    background-color: #2d3748;
    color: #e2e8f0;
}

/* ===============================================
   == DEFINITIVE FIX FOR DARK MODE SCROLLBAR    ==
   =============================================== */

/* กำหนดสไตล์ Scrollbar สำหรับ Dark Mode โดยเฉพาะ */
body.dark-mode *::-webkit-scrollbar {
    background: #21222c; /* สีพื้นหลังของราง Scrollbar */
    width: 12px;
}

body.dark-mode *::-webkit-scrollbar-thumb {
    background-color: #718096;  /* สีของตัวเลื่อน */
    border-radius: 6px;
    border: 3px solid #21222c; /* สีเดียวกับพื้นหลังของรางเพื่อสร้างเอฟเฟกต์ padding */
}

body.dark-mode *::-webkit-scrollbar-thumb:hover {
    background-color: #a0aec0; /* สีตอนเอาเมาส์ไปวาง */
}